<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>æˆ‘çš„å°ç«™</title>
  <style>
    body{font-family:Arial;margin:40px;background:#f7f7f7}
    #greetBox{background:#fff;padding:30px;border-radius:8px;text-align:center}
    #guestbook{display:none;background:#fff;padding:30px;border-radius:8px;margin-top:20px}
    textarea{width:100%;height:80px;margin-top:10px}
    button{padding:8px 20px;margin-top:10px}
  </style>
</head>
<body>

<!-- 1. é—®å€™ -->
<div id="greetBox">
  <h1>æ¬¢è¿æ¥åˆ° zt çš„ä¸ªäººå°ç«™ï¼ ğŸ‰</h1>
  <p>ç‚¹ä¸‹é¢æŒ‰é’®å³å¯ç•™è¨€</p>
  <button onclick="showGuestbook()">ztæ˜¯ä¸ªå¥½äºº</button>
</div>

<!-- 2. ç•™è¨€æ¿ï¼ˆåˆå§‹éšè—ï¼‰ -->
<div id="guestbook">
  <h2>ç•™è¨€æ¿ ğŸ’¬</h2>
  <form id="msgForm">
    <input id="nickname" placeholder="æ˜µç§°" required><br>
    <textarea id="message" placeholder="è¯´ç‚¹ä»€ä¹ˆâ€¦" required></textarea><br>
    <button>å‘é€</button>
  </form>
  <ul id="msgList"></ul>
</div>

<script>
// æ˜¾ç¤ºç•™è¨€æ¿
function showGuestbook(){
  document.getElementById('greetBox').style.display = 'none';
  document.getElementById('guestbook').style.display = 'block';
  loadMessages();   // é¡ºä¾¿åŠ è½½å·²æœ‰ç•™è¨€
}

// è¯»å–å·²æœ‰ç•™è¨€ï¼ˆGitHub Issuesï¼‰
function loadMessages(){
  const USER = 'ztxiaopaipai';
  const REPO = 'ztxiaopaipai.github.io';
  fetch(`https://api.github.com/repos/${USER}/${REPO}/issues?labels=guestbook`)
    .then(r=>r.json())
    .then(issues=>{
      const list = document.getElementById('msgList');
      list.innerHTML = '';
      issues.forEach(issue=>{
        const li = document.createElement('li');
        li.innerHTML = `<strong>${issue.title}</strong>: ${issue.body}`;
        list.appendChild(li);
      });
    });
}

// æäº¤ç•™è¨€ï¼ˆè·³è½¬åˆ° GitHub æ–°å»º Issueï¼‰
document.getElementById('msgForm').addEventListener('submit', e=>{
  e.preventDefault();
  const title = document.getElementById('nickname').value;
  const body  = document.getElementById('message').value;
  const url = `https://github.com/ztxiaopaipai/ztxiaopaipai.github.io/issues/new?labels=guestbook&title=${encodeURIComponent(title)}&body=${encodeURIComponent(body)}`;
  window.open(url, '_blank');
});
</script>

</body>
</html>
